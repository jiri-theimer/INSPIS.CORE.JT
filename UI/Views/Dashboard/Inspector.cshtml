@model UI.Models.Dashboard.DashboardInspector
@inject BL.Factory _f

@{
    ViewData["Title"] = _f.tra("Osobní stránka inspektora") + ": " + Model.Rec.FullNameAsc;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@addTagHelper *, UI

<h4 class="nonmobile">@ViewData["Title"]</h4>

<div class="row py-3 bg-light m-0">

    <div class="col-sm-4">
        <mysearch asp-for="@Model.SearchBoxA01" entity="a01Event" placeholder="@_f.tra("Fulltext: Akce")..."></mysearch>
    </div>
    <div class="col-sm-4">
        <mysearch asp-for="@Model.SearchBoxA03" entity="a03Institution" placeholder="@_f.tra("Fulltext: Instituce")..."></mysearch>
    </div>
    <div class="col-sm-1"></div>
    <div class="nonmobile nontablet">
        <a class="btn btn-secondary" href="/Dashboard/Inspector">@(_f.tra("Občerstvit"))</a>
    </div>




</div>
<table>
    <tr>
        <td>
            <select class="form-control" asp-for="@Model.GridMasterFilter">
                <option value="">@_f.tra("Účastník akce")</option>
                <option value="leader">@_f.tra("Vedoucí akce")</option>
                <option value="member">@_f.tra("Člen akce")</option>
                <option value="issuer">@_f.tra("Vlastník akce")</option>
            </select>
        </td>
        <td>
            @Html.EditorFor(m => m.PeriodFilter, "~/Views/Shared/_Period.cshtml")
        </td>
    </tr>
</table>
        
    

<vc:the-grid entity="a01Event" j72id="0" go2pid="0" master_entity="j02User" master_pid="@Model.pid" contextmenuflag="1" ondblclick="tg_dblclick" master_flag="@Model.GridMasterFilter" masterviewflag="3"></vc:the-grid>



<script type="text/javascript">
    $(document).ready(function () {
        $("#GridMasterFilter").val("@Model.GridMasterFilter");


        $("#GridMasterFilter").change(function () {
            
            $.post("/Common/SetUserParam", { key: "DashboardInspector-masterflag", value: $(this).val() }, function (data) {
                reload();

            });

            
        });

        $("#PeriodValue").on("change", function () {
            $.post("/Common/SetUserParam", { key: "report-period-value", value: $(this).val() }, function (data) {
                reload();

            });
        });

    });

    function reload() {

        location.replace("/Dashboard/Inspector?masterflag=" + $("#GridMasterFilter").val());
    }
    
</script>